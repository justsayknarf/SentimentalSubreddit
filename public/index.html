<!DOCTYPE html>

<html ng-app="sentimentalApp">
   <head>
      <title>SentimentalSubreddit</title>

      <!-- jQuery -->
      <script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>

      <!-- Foundation -->
      <link rel="stylesheet" href="/public/css/foundation.css">
      <script src="/public/scripts/foundation.js"></script>

      <!-- FontAwesome -->
      <script src="https://use.fontawesome.com/0a3f31b4cd.js"></script>

      <link href="https://fonts.googleapis.com/css?family=Abel|Poiret+One" rel="stylesheet">

      <link href="http://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet" type="text/css">

      <link href="http://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet" type="text/css">
      <link href="/public/css/app.css" rel="stylesheet" type="text/css">
<!--       <link href="/public/css/main.css" rel="stylesheet" type="text/css"> -->
   </head>

   <body>
      <header>
         <h1 class="clementine-text">Sentimental Subreddits</p>
      </header>

   
      <div class="mainContainer" ng-controller="subrController">

         <div class="search">
            <form name="searchForm" ng-submit="submitSearch()" novalidate>
               <span class="fa fa-search"></span>
               <input type="search" placeholder="Look up a subreddit" ng-model="subrSearch.name">

               <button type="submit" class="button">Submit</button>
            </form>
         </div>

         <div class="row">

            <div class="alert alert-info">
               <p>Sort Type: {{ sortType }}</p>
               <p>Sort Reverse: {{ sortReverse }}</p>
               <p>Search Query: {{ subrSearch }}</p>
            </div>

         <table class="table table-bordered table-striped">
            <thead>
               <tr>
                  <td>
                  <a href="#" ng-click="sortType = 'name'; sortReverse = !sortReverse">
                     Subreddits 
                     <span ng-show="sortType == 'name'" class="fa fa-caret-down"></span>
                  </a>
                  </td>
                  <td>
                  <a href="#" ng-click="sortType = 'sentiment'; sortReverse = !sortReverse">
                  Overall Sentiment 
                  <span ng-show="sortType == 'sentiment'" class="fa fa-caret-down"></span>
                  </a>
                  </td>
                  <td>
                  <a href="#" ng-click="sortType = 'lastUpdated'; sortReverse = !sortReverse">
                  Last Updated
                  <span ng-show="sortType == 'lastUpdated'" class="fa fa-caret-down"></span>
                  </a>
                  </td>
               </tr>
            </thead>

            <tbody>
               <tr ng-repeat="subreddit in subrList | orderBy:sortType:sortReverse | filter:subrSearch">
                  <td>{{ subreddit.name }}</td>
                  <td>0</td>
                  <td>{{ subreddit.lastUpdated }}</td>
               </tr>
               {{subrList.length}}
               <p ng-hide="subrList.length">Subreddit not in database yet! <a ng-click="addSubreddit(subrSearch)">Add?</a></p>
            </tbody> 
         </table>
         </div>
<hr>
         <h2>Subreddits: </h2>
         <div class="row" ng-repeat="subreddit in subrList">
            <a href="#" ng-click="showTopPosts($index, subreddit._id)">{{subreddit.name}} </a>

            <div ng-show="showPosts[$index]" class="row">
               {{ postData[subreddit.id] }}
               <div ng-repeat="post in postData[subreddit._id].posts">
                  <a href="{{redditUrl + post.url}}">{{post.title}}</a>
                  <br>
                  Sentiment: {{post.sentimentType}} // Score: {{post.sentimentScore}}
                  <hr>  
               </div>
               
            </div>
         </div>
      </div>
   

      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-resource.min.js"></script>
      <script type="text/javascript" src="controllers/subrController.client.js"></script>
   </body>

</html>